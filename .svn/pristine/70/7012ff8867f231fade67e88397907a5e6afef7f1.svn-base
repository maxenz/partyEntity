Imports WeifenLuo.WinFormsUI.Docking
Imports ShamanClases
Public Class frmTrasladosABM
    Inherits DockContent
    Private objIncidentes As New sysEmergencyC.Incidentes
    '------> flgs Privados
    Private flgSetGrado As Boolean = False
    Private Sub FormatScreen()
        'Dim objGrado As New Emergency.clsGradosOperativos
        '----> Formulario
        Me.BackColor = Color.Beige
        Me.KeyPreview = True
        '----> Grupo
        SetFormatTabControl(Me.tabTraslado)
        SetFormatGroupBox(Me.grpMain)
        SetFormatGroupBox(Me.grpOrigen)
        SetFormatGroupBox(Me.grpDestino)
        SetFormatGroupBox(Me.grpAnexo1)
        SetFormatGroupBox(Me.grpAnexo2)
        '----> ToolStrips
        SetFormatToolStrip(Me.tbrMain, Main.imlIconos)
        Me.tbrMain.Tag = 1
        '----> Combos
        'comboSexo(Me.cmbSexo)
        'comboIva(Me.cmbIvas, True)
        'objGrado.Combo(Me.cmbGrados)
        '----> Combos
        SetEnabled(False)
        '----> Abro Ultimo del día
        ShowIncidente(objIncidentes.MoveLast(Now.Date))
    End Sub
    Private Sub SetEnabled(ByVal pEst As Boolean)
        Dim Control As Control
        For Each Control In Me.grpMain.Controls
            If Control.Name = "txtTrasladoId" Or Control.Name = "dtpFecIncidente" Or Control.Name = "txtNroIncidente" Then
                Control.Enabled = False
            Else
                Control.Enabled = pEst
            End If
        Next
        For Each Control In Me.grpOrigen.Controls
            If Control.Name = "txtLocalidadDes" Or Control.Name = "txtPartido" Then
                Control.Enabled = False
            Else
                Control.Enabled = pEst
            End If
        Next
        For Each Control In Me.grpDestino.Controls
            If Control.Name = "txtDstLocalidadDes" Or Control.Name = "txtDstPartido" Or Control.Name = "dtpFecRetorno" Or Control.Name = "mskHorRetorno" Then
                Control.Enabled = False
            Else
                Control.Enabled = pEst
            End If
        Next
        For Each Control In Me.grpAnexo1.Controls
            If Control.Name = "txtAn1LocalidadDes" Or Control.Name = "txtAn1Partido" Or Control.Name = "dtpAn1Fecha" Or Control.Name = "mskAn1Hora" Then
                Control.Enabled = False
            Else
                Control.Enabled = pEst
            End If
        Next
        For Each Control In Me.grpAnexo2.Controls
            If Control.Name = "txtAn2LocalidadDes" Or Control.Name = "txtAn2Partido" Or Control.Name = "dtpAn2Fecha" Or Control.Name = "mskAn2Hora" Then
                Control.Enabled = False
            Else
                Control.Enabled = pEst
            End If
        Next
        flgSetGrado = False
    End Sub
    Private Sub ClearValues()
        Dim Control As Control
        For Each Control In grpMain.Controls
            If Control.Name <> "txtTrasladoId" And Control.GetType.Name <> "Label" And Control.GetType.Name <> "CheckBox" Then
                Control.Text = ""
            End If
        Next
        For Each Control In Me.grpOrigen.Controls
            If Control.GetType.Name <> "Label" Then Control.Text = ""
        Next
        For Each Control In Me.grpDestino.Controls
            If Control.GetType.Name <> "Label" Then Control.Text = ""
        Next
        For Each Control In Me.grpAnexo1.Controls
            If Control.GetType.Name <> "Label" Then Control.Text = ""
        Next
        For Each Control In Me.grpAnexo2.Controls
            If Control.GetType.Name <> "Label" Then Control.Text = ""
        Next
    End Sub
    Private Sub SetToolStrip(Optional ByVal pMod As Byte = 1)
        Dim vIdx As Integer
        If pMod = 1 Then
            tbrMain.Tag = 1
            tbrMain.Items(tbrMain.Items.IndexOfKey("agregar")).Image = Main.imlIconos.Images(Main.imlIconos.Images.IndexOfKey("agregar"))
            tbrMain.Items(tbrMain.Items.IndexOfKey("eliminar")).Image = Main.imlIconos.Images(Main.imlIconos.Images.IndexOfKey("eliminar"))
            For vIdx = 2 To tbrMain.Items.Count - 1
                tbrMain.Items(vIdx).Enabled = True
            Next vIdx
        Else
            tbrMain.Tag = 2
            tbrMain.Items(tbrMain.Items.IndexOfKey("agregar")).Image = Main.imlIconos.Images(Main.imlIconos.Images.IndexOfKey("salvar"))
            tbrMain.Items(tbrMain.Items.IndexOfKey("eliminar")).Image = Main.imlIconos.Images(Main.imlIconos.Images.IndexOfKey("cancelar"))
            For vIdx = 2 To tbrMain.Items.Count - 1
                tbrMain.Items(vIdx).Enabled = False
            Next vIdx
        End If
    End Sub
    Private Sub SetFormatToolStrip(ByVal pTbr As ToolStrip, ByVal pIco As ImageList)

        'With pTbr

        '    .ImageScalingSize = New System.Drawing.Size(16, 16)
        '    .BackColor = Color.Beige

        '    Dim btnAgregar = New ToolStripButton
        '    btnAgregar = MakeToolStripButton(pIco.Images(pIco.Images.IndexOfKey("agregar")), "Agregar")
        '    Dim btnEliminar = New ToolStripButton
        '    btnEliminar = MakeToolStripButton(pIco.Images(pIco.Images.IndexOfKey("eliminar")), "Eliminar")
        '    Dim btnModificar = New ToolStripButton
        '    btnModificar = MakeToolStripButton(pIco.Images(pIco.Images.IndexOfKey("modificar")), "Modificar")
        '    Dim btnConsultar = New ToolStripButton
        '    btnConsultar = MakeToolStripButton(pIco.Images(pIco.Images.IndexOfKey("refrescar")), "Refrescar")
        '    Dim btnPrimero = New ToolStripButton
        '    btnPrimero = MakeToolStripButton(pIco.Images(pIco.Images.IndexOfKey("qutodos")), "Primero")
        '    Dim btnAnterior = New ToolStripButton
        '    btnAnterior = MakeToolStripButton(pIco.Images(pIco.Images.IndexOfKey("quuno")), "Anterior")
        '    Dim btnSiguiente = New ToolStripButton
        '    btnSiguiente = MakeToolStripButton(pIco.Images(pIco.Images.IndexOfKey("aguno")), "Siguiente")
        '    Dim btnUltimo = New ToolStripButton
        '    btnUltimo = MakeToolStripButton(pIco.Images(pIco.Images.IndexOfKey("agtodos")), "Ultimo")

        '    .Items.AddRange(New System.Windows.Forms.ToolStripItem() {btnAgregar, btnEliminar, btnModificar, btnConsultar, btnPrimero, btnAnterior, btnSiguiente, btnUltimo})


        'End With

    End Sub

    Private Sub SetButtonFunction(ByVal pKey As String)
        Dim vIdGet As Long = 0

        If tbrMain.Tag = 1 Then
            Select Case pKey
                Case "Agregar"
                    SetToolStrip(2)
                    ClearValues()
                    'Me.txtTrasladoId.Text = objLocks.getNewTraslado()
                    'objIncidentesExp.CleanProperties(objIncidentesExp)
                    'SetEnabled(True)
                    'Me.txtClienteId.Focus()
                Case "Eliminar"
                    'If MsgBox("¿ Elimina el servicio " & objIncidentesExp.NroIncidente & "?", MsgBoxStyle.Question Or MsgBoxStyle.YesNo, "Eliminar") = MsgBoxResult.Yes Then
                    '    If objIncidentesExp.Eliminar(objIncidentesExp.ID) Then
                    '        vIdGet = objIncidentes.MoveLast(Me.dtpFecIncidente.Value.Date)
                    '        If vIdGet > 0 Then
                    '            ShowIncidente(vIdGet)
                    '        Else
                    '            ClearValues()
                    '        End If
                    '    End If
                    'End If
                Case "Modificar"
                    'If objIncidentesExp.Abrir(objIncidentesExp.ID) Then
                    '    If objLocks.lockTraslado(objIncidentesExp.TrasladoId) Then
                    '        SetToolStrip(2)
                    '        SetEnabled(True)
                    '        Me.txtObservaciones.Text = ""
                    '        flgSetGrado = True
                    '        Me.txtClienteId.Focus()
                    '    End If
                    'End If
                Case "Refrescar"
                    ShowIncidente(vIdGet)
                Case "Primero"
                    'vIdGet = objIncidentesExp.MoveFirst(Me.dtpFecIncidente.Value.Date, False)
                    'If vIdGet > 0 Then ShowIncidente(vIdGet)
                Case "Anterior"
                    'vIdGet = objIncidentesExp.MovePrevious(Me.dtpFecIncidente.Value.Date, objIncidentesExp.ID, False)
                    'If vIdGet > 0 Then ShowIncidente(vIdGet)
                Case "Siguiente"
                    'vIdGet = objIncidentesExp.MoveNext(Me.dtpFecIncidente.Value.Date, objIncidentesExp.ID, False)
                    'If vIdGet > 0 Then ShowIncidente(vIdGet)
                Case "Ultimo"
                    vIdGet = objIncidentes.MoveLast(Me.dtpFecIncidente.Value.Date)
                    If vIdGet > 0 Then ShowIncidente(vIdGet)
            End Select
        Else
            Select Case pKey
                Case "Agregar"
                    Actualizar()
                Case "Eliminar"
                    'objLocks.unlockTraslado(Val(Me.txtTrasladoId.Text))
                    'SetEnabled(False)
                    'SetToolStrip(1)
                Case "Modificar"
                Case "Refrescar"
            End Select
        End If

    End Sub
    Private Function Actualizar() As Boolean
        'Dim objIncidenteDomicilio As New ShamanCache.clsIncidentesDomicilios, objDstIncidenteDomicilio As New ShamanCache.clsIncidentesDomicilios
        'Dim objAn1IncidenteDomicilio As New ShamanCache.clsIncidentesDomicilios, objAn2IncidenteDomicilio As New ShamanCache.clsIncidentesDomicilios
        'Dim objIncidenteObservacion As New ShamanCache.clsIncidentesObservaciones
        'Actualizar = False
        ''---------> Cabecera del Inicidente
        'With objIncidentesExp
        '    .FecIncidente = Me.dtpFecIncidente.Value.Date
        '    .NroIncidente = Me.txtNroIncidente.Text
        '    .TrasladoId = Val(Me.txtTrasladoId.Text)
        '    .Telefono = Me.txtTelefono.Text
        '    .GradoOperativoId.SetObjectId(getItemData(Me.cmbGrados))
        '    .ClienteId.SetObjectId(Val(Me.txtClienteId.Tag))
        '    .ClienteIntegranteId.SetObjectId(Val(Me.txtNroAfiliado.Tag))
        '    .NroAfiliado = Me.txtNroAfiliado.Text
        '    .Paciente = Me.txtPaciente.Text
        '    .Sexo = Me.cmbSexo.Text
        '    .Edad = GetDouble(Me.txtEdad.Text)
        '    .PlanId = Me.cmbPlanes.Text
        '    .Sintomas = Me.txtSintomas.Text
        '    .CoPago = GetDouble(Me.txtCoPago.Text)
        '    .trsIdaVuelta = Me.chkRetorno.CheckState
        '    If getItemData(Me.cmbIvas) = 2 Then
        '        .flgIvaGravado = 1
        '    Else
        '        .flgIvaGravado = getItemData(Me.cmbIvas)
        '    End If
        'End With
        ''---------> Domiclio Origen
        'With objIncidenteDomicilio
        '    .CleanProperties(objIncidenteDomicilio)
        '    .SanatorioId.SetObjectId(.SanatorioId.GetIDByAbreviaturaId(Me.txtSanatorioId.Text))
        '    .LocalidadId.SetObjectId(.LocalidadId.GetIDByAbreviaturaId(Me.txtLocalidadId.Text))
        '    .Domicilio.dmCalle = Me.txtCalle.Text
        '    .Domicilio.dmAltura = Val(Me.txtAltura.Text)
        '    .Domicilio.dmPiso = Me.txtPiso.Text
        '    .Domicilio.dmDepto = Me.txtDepartamento.Text
        '    .Domicilio.dmEntreCalle1 = Me.txtEntreCalle1.Text
        '    .Domicilio.dmEntreCalle2 = Me.txtEntreCalle2.Text
        '    .Domicilio.dmReferencia = Me.txtReferencias.Text
        'End With
        ''---------> Domiclio Destino
        'With objDstIncidenteDomicilio
        '    .CleanProperties(objDstIncidenteDomicilio)
        '    .SanatorioId.SetObjectId(.SanatorioId.GetIDByAbreviaturaId(Me.txtDstSanatorioId.Text))
        '    .LocalidadId.SetObjectId(.LocalidadId.GetIDByAbreviaturaId(Me.txtDstLocalidadId.Text))
        '    .Domicilio.dmCalle = Me.txtDstCalle.Text
        '    .Domicilio.dmAltura = Val(Me.txtDstAltura.Text)
        '    .Domicilio.dmPiso = Me.txtDstPiso.Text
        '    .Domicilio.dmDepto = Me.txtDstDepartamento.Text
        '    .Domicilio.dmEntreCalle1 = Me.txtDstEntreCalle1.Text
        '    .Domicilio.dmEntreCalle2 = Me.txtDstEntreCalle2.Text
        '    .Domicilio.dmReferencia = Me.txtDstReferencias.Text
        'End With
        ''---------> Domiclio Anexo I
        'With objAn1IncidenteDomicilio
        '    .CleanProperties(objAn1IncidenteDomicilio)
        '    .SanatorioId.SetObjectId(.SanatorioId.GetIDByAbreviaturaId(Me.txtAn1SanatorioId.Text))
        '    .LocalidadId.SetObjectId(.LocalidadId.GetIDByAbreviaturaId(Me.txtAn1LocalidadId.Text))
        '    .Domicilio.dmCalle = Me.txtAn1Calle.Text
        '    .Domicilio.dmAltura = Val(Me.txtAn1Altura.Text)
        '    .Domicilio.dmPiso = Me.txtAn1Piso.Text
        '    .Domicilio.dmDepto = Me.txtAn1Departamento.Text
        '    .Domicilio.dmEntreCalle1 = Me.txtAn1EntreCalle1.Text
        '    .Domicilio.dmEntreCalle2 = Me.txtAn1EntreCalle2.Text
        '    .Domicilio.dmReferencia = Me.txtAn1Referencias.Text
        'End With
        ''---------> Domiclio Anexo II
        'With objAn2IncidenteDomicilio
        '    .CleanProperties(objAn2IncidenteDomicilio)
        '    .SanatorioId.SetObjectId(.SanatorioId.GetIDByAbreviaturaId(Me.txtAn2SanatorioId.Text))
        '    .LocalidadId.SetObjectId(.LocalidadId.GetIDByAbreviaturaId(Me.txtAn2LocalidadId.Text))
        '    .Domicilio.dmCalle = Me.txtAn2Calle.Text
        '    .Domicilio.dmAltura = Val(Me.txtAn2Altura.Text)
        '    .Domicilio.dmPiso = Me.txtAn2Piso.Text
        '    .Domicilio.dmDepto = Me.txtAn2Departamento.Text
        '    .Domicilio.dmEntreCalle1 = Me.txtAn2EntreCalle1.Text
        '    .Domicilio.dmEntreCalle2 = Me.txtAn2EntreCalle2.Text
        '    .Domicilio.dmReferencia = Me.txtAn2Referencias.Text
        'End With
        ''--------> Observaciones
        'With objIncidenteObservacion
        '    .CleanProperties(objIncidenteObservacion)
        '    .Observaciones = Me.txtObservaciones.Text
        'End With
        ''--------> Salvo Incidente
        'If objIncidentesExp.SetTraslado(objIncidentesExp, objIncidenteDomicilio, objDstIncidenteDomicilio, objAn1IncidenteDomicilio, objAn2IncidenteDomicilio, objIncidenteObservacion, SetToDateTime(Me.dtpFecOrigen.Value.Date, Me.mskHorOrigen.Text), _
        '    SetToDateTime(Me.dtpFecDestino.Value.Date, Me.mskHorDestino.Text), SetToDateTime(Me.dtpFecRetorno.Value.Date, Me.mskHorRetorno.Text)) Then
        '    objLocks.unlockTraslado(objIncidentesExp.TrasladoId)
        '    Actualizar = True
        '    SetEnabled(False)
        '    ShowIncidente(objIncidentesExp.ID)
        '    SetToolStrip(1)
        'End If
    End Function

    Private Sub SetCoberturaCoPago()
        'Dim objCobertura As New clsClientesGradosOperativos, objGrado As New Emergency.clsGradosOperativos
        'If flgSetGrado And Me.txtClienteId.Enabled Then
        '    If objGrado.Abrir(getItemData(Me.cmbGrados)) Then
        '        If objCobertura.Abrir(objCobertura.GetIDByIndex(Val(Me.txtClienteId.Tag), objGrado.GradoAgrupacionId.ID)) Then
        '            If objCobertura.flgCubierto = 1 Then
        '                Me.txtCoPago.Text = prnDbl(objCobertura.CoPago)
        '            Else
        '                MsgBox("El cliente no tiene cubierto dicho grado", MsgBoxStyle.Critical, "Cobertura")
        '            End If
        '        End If
        '    End If
        'End If
        'objGrado = Nothing
        'objCobertura = Nothing

    End Sub

    Public Sub ShowIncidente(ByVal pInc As Long)
        'Dim objDomicilio As New ShamanCache.clsIncidentesDomicilios, objViaje As New ShamanCache.clsIncidentesViajes
        'If objIncidentesExp.Abrir(pInc) Then
        '    ClearValues()
        '    Me.txtTrasladoId.Text = objIncidentesExp.TrasladoId
        '    Me.dtpFecIncidente.Text = objIncidentesExp.FecIncidente
        '    Me.txtNroIncidente.Text = objIncidentesExp.NroIncidente
        '    Me.txtClienteId.Text = objIncidentesExp.ClienteId.AbreviaturaId
        '    Me.txtNroAfiliado.Text = objIncidentesExp.NroAfiliado
        '    Me.txtTelefono.Text = objIncidentesExp.Telefono
        '    Me.cmbSexo.Text = objIncidentesExp.Sexo
        '    Me.txtEdad.Text = Math.Round(objIncidentesExp.Edad, 0)
        '    Me.txtSintomas.Text = objIncidentesExp.Sintomas
        '    'Me.cmbGrados.Text = objIncidentesExp.GradoOperativoId.Descripcion
        '    Me.txtPaciente.Text = objIncidentesExp.Paciente
        '    Me.txtCoPago.Text = objIncidentesExp.CoPago
        '    Me.chkRetorno.CheckState = objIncidentesExp.trsIdaVuelta
        '    Me.cmbIvas.SelectedIndex = objIncidentesExp.flgIvaGravado + 1
        '    Me.txtObservaciones.Text = objIncidentesExp.Observaciones
        '    '-------> Domicilios
        '    If objDomicilio.Abrir(objDomicilio.GetIDByIndex(objIncidentesExp.ID)) Then
        '        ShowDomicilio(objDomicilio, Me.grpOrigen, Me.txtSanatorioId, Me.txtLocalidadId, Me.txtLocalidadDes, Me.txtCalle, Me.txtAltura, Me.txtPiso, Me.txtDepartamento, Me.txtEntreCalle1, Me.txtEntreCalle2, Me.txtPartido, Me.txtReferencias)
        '    End If
        '    If objDomicilio.Abrir(objDomicilio.GetIDByIndex(objIncidentesExp.ID, 1)) Then
        '        ShowDomicilio(objDomicilio, Me.grpDestino, Me.txtDstSanatorioId, Me.txtDstLocalidadId, Me.txtDstLocalidadDes, Me.txtDstCalle, Me.txtDstAltura, Me.txtDstPiso, Me.txtDstDepartamento, Me.txtDstEntreCalle1, Me.txtDstEntreCalle2, Nothing, Me.txtDstReferencias)
        '    End If
        '    If objDomicilio.Abrir(objDomicilio.GetIDByIndex(objIncidentesExp.ID, 2, 1)) Then
        '        ShowDomicilio(objDomicilio, Me.grpAnexo1, Me.txtAn1SanatorioId, Me.txtAn1LocalidadId, Me.txtAn1LocalidadDes, Me.txtAn1Calle, Me.txtAn1Altura, Me.txtAn1Piso, Me.txtAn1Departamento, Me.txtAn1EntreCalle1, Me.txtAn1EntreCalle2, Me.txtAn1Partido, Me.txtAn1Referencias)
        '    Else
        '        Me.grpAnexo1.Text = "Anexo I"
        '    End If
        '    If objDomicilio.Abrir(objDomicilio.GetIDByIndex(objIncidentesExp.ID, 2, 2)) Then
        '        ShowDomicilio(objDomicilio, Me.grpAnexo2, Me.txtAn2SanatorioId, Me.txtAn2LocalidadId, Me.txtAn2LocalidadDes, Me.txtAn2Calle, Me.txtAn2Altura, Me.txtAn2Piso, Me.txtAn2Departamento, Me.txtAn2EntreCalle1, Me.txtAn2EntreCalle2, Me.txtAn2Partido, Me.txtAn2Referencias)
        '    Else
        '        Me.grpAnexo1.Text = "Anexo II"
        '    End If
        '    objDomicilio = Nothing
        '    '----> Viajes
        '    If objViaje.Abrir(objViaje.GetIDByIndex(objIncidentesExp.ID)) Then
        '        Me.dtpFecOrigen.Value = ShowDateTime(objViaje.reqHorLlegada)
        '        Me.mskHorOrigen.Text = ShowDateTime(objViaje.reqHorLlegada, 1)
        '        Me.dtpFecDestino.Value = ShowDateTime(objViaje.reqHorInternacion)
        '        Me.mskHorDestino.Text = ShowDateTime(objViaje.reqHorInternacion, 1)
        '    End If
        '    If objViaje.Abrir(objViaje.GetIDByIndex(objIncidentesExp.ID, "VUE")) Then
        '        Me.dtpFecRetorno.Value = ShowDateTime(objViaje.reqHorLlegada)
        '        Me.mskHorRetorno.Text = ShowDateTime(objViaje.reqHorLlegada, 1)
        '    End If
        '    If objViaje.Abrir(objViaje.GetIDByIndex(objIncidentesExp.ID, "AN1")) Then
        '        Me.dtpAn1Fecha.Value = ShowDateTime(objViaje.reqHorLlegada)
        '        Me.mskAn1Hora.Text = ShowDateTime(objViaje.reqHorLlegada, 1)
        '    End If
        '    If objViaje.Abrir(objViaje.GetIDByIndex(objIncidentesExp.ID, "AN2")) Then
        '        Me.dtpAn2Fecha.Value = ShowDateTime(objViaje.reqHorLlegada)
        '        Me.mskAn2Hora.Text = ShowDateTime(objViaje.reqHorLlegada, 1)
        '    End If
        'End If
    End Sub
    'Private Sub ShowDomicilio(ByVal objDomicilio As clsIncidentesDomicilios, ByVal pGrp As GroupBox, ByVal pSan As TextBox, ByVal pLoc As TextBox, ByVal pLds As TextBox, ByVal pCal As TextBox, ByVal pAlt As TextBox, ByVal pPis As TextBox, ByVal pDep As TextBox, ByVal pEt1 As TextBox, ByVal pEt2 As TextBox, ByVal pPar As TextBox, ByVal pRef As TextBox)
    '    pSan.Text = objDomicilio.SanatorioId.AbreviaturaId
    '    pLoc.Text = objDomicilio.LocalidadId.AbreviaturaId
    '    pLds.Text = objDomicilio.LocalidadId.Descripcion
    '    pCal.Text = objDomicilio.Domicilio.dmCalle
    '    pAlt.Text = objDomicilio.Domicilio.dmAltura
    '    pPis.Text = objDomicilio.Domicilio.dmPiso
    '    pDep.Text = objDomicilio.Domicilio.dmDepto
    '    pEt1.Text = objDomicilio.Domicilio.dmEntreCalle1
    '    pEt2.Text = objDomicilio.Domicilio.dmEntreCalle2
    '    If Not pPar Is Nothing Then pPar.Text = objDomicilio.LocalidadId.PartidoId.Descripcion
    '    If objDomicilio.SanatorioId.ID > 0 Then
    '        Select Case pSan.Tag
    '            Case 1 : pGrp.Text = "Origen: " & objDomicilio.SanatorioId.Descripcion
    '            Case 2 : pGrp.Text = "Destino: " & objDomicilio.SanatorioId.Descripcion
    '            Case 3 : pGrp.Text = "Anexo I: " & objDomicilio.SanatorioId.Descripcion
    '            Case 4 : pGrp.Text = "Anexo II: " & objDomicilio.SanatorioId.Descripcion
    '        End Select
    '    Else
    '        Select Case pSan.Tag
    '            Case 1 : pGrp.Text = "Origen"
    '            Case 2 : pGrp.Text = "Destino"
    '            Case 3 : pGrp.Text = "Anexo I"
    '            Case 4 : pGrp.Text = "Anexo II"
    '        End Select
    '    End If
    'End Sub

    'Public Sub SetIntegrante(Optional ByVal pIte As Long = 0, Optional ByVal pCli As Long = 0, Optional ByVal pAfl As String = "")
    '    Dim objClienteIntegrante As New ShamanCache.clsClientesIntegrantes
    '    If pIte = 0 Then pIte = objClienteIntegrante.GetIDByNroAfiliado(pCli, pAfl)
    '    If pIte > 0 Then
    '        If objClienteIntegrante.Abrir(pIte) Then
    '            Me.txtNroAfiliado.Tag = objClienteIntegrante.ID
    '            Me.txtNroAfiliado.Text = objClienteIntegrante.NroAfiliado
    '            If Me.txtTelefono.Text = "" Then Me.txtTelefono.Text = objClienteIntegrante.Telefono01
    '            Me.txtObservaciones.Text = objClienteIntegrante.Observaciones
    '            If Me.txtLocalidadId.Text = "" Then
    '                Me.txtLocalidadId.Text = objClienteIntegrante.LocalidadId.AbreviaturaId
    '                Me.txtLocalidadDes.Text = objClienteIntegrante.LocalidadId.Descripcion
    '                Me.txtPartido.Text = objClienteIntegrante.LocalidadId.PartidoId.Descripcion
    '            End If
    '            If Me.txtCalle.Text = "" Then
    '                Me.txtCalle.Text = objClienteIntegrante.Domicilio.dmCalle
    '                Me.txtAltura.Text = objClienteIntegrante.Domicilio.dmAltura
    '                Me.txtPiso.Text = objClienteIntegrante.Domicilio.dmPiso
    '                Me.txtDepartamento.Text = objClienteIntegrante.Domicilio.dmDepto
    '                Me.txtEntreCalle1.Text = objClienteIntegrante.Domicilio.dmEntreCalle1
    '                Me.txtEntreCalle2.Text = objClienteIntegrante.Domicilio.dmEntreCalle2
    '                Me.txtReferencias.Text = objClienteIntegrante.Domicilio.dmReferencia
    '            End If
    '            If Me.txtPaciente.Text = "" And objClienteIntegrante.TipoIntegrante = "PER" Then
    '                Me.cmbSexo.Text = objClienteIntegrante.Sexo
    '                Me.txtPaciente.Text = objClienteIntegrante.Apellido & ", " & objClienteIntegrante.Nombre
    '            End If
    '        Else
    '            Me.txtNroAfiliado.Tag = 0
    '        End If
    '    Else
    '        Me.txtNroAfiliado.Tag = 0
    '    End If
    '    objClienteIntegrante = Nothing
    'End Sub

    Private Sub frmTrasladosABM_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles Me.KeyDown
        Select Case e.KeyCode
            Case Keys.Enter
                e.Handled = True
                SendKeys.Send("{TAB}")
            Case Keys.F10
                Actualizar()
        End Select
    End Sub
    Private Sub frmTrasladosABM_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        FormatScreen()
    End Sub
    Private Sub tbrMain_ItemClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.ToolStripItemClickedEventArgs) Handles tbrMain.ItemClicked
        SetButtonFunction(e.ClickedItem.Name)
    End Sub

    Private Sub txtClienteId_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles txtClienteId.KeyDown
        If e.KeyCode = Keys.F2 Then
            callInfo = Name
            'ShowChildFormFloat(frmClientesSearch, Me.DockPanel)
        End If
    End Sub

    Private Sub txtClienteId_LostFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles txtClienteId.LostFocus
        'Dim objClienteId As New ShamanCache.clsClientes
        'If objClienteId.Abrir(objClienteId.GetIDByAbreviaturaId(txtClienteId.Text)) Then
        '    txtClienteId.Tag = objClienteId.ID
        '    txtClienteId.Text = objClienteId.AbreviaturaId
        'Else
        '    txtClienteId.Tag = 0
        '    txtClienteId.Text = ""
        'End If
        'SetCoberturaCoPago()
        'objClienteId = Nothing

    End Sub

    Private Sub txtNroAfiliado_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles txtNroAfiliado.KeyDown
        'If e.KeyCode = Keys.F2 Then
        '    If Val(txtClienteId.Tag) > 0 Then
        '        callInfo = Name
        '        ShowChildFormFloat(frmClientesIntegrantesSearch, Me.DockPanel)
        '    Else
        '        MsgBox("Debe determinar el cliente para acceder a esta búsqueda", MsgBoxStyle.Critical)
        '    End If
        'End If
    End Sub

    Private Sub txtNroAfiliado_LostFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles txtNroAfiliado.LostFocus
        'If Val(txtClienteId.Tag) > 0 Then
        '    SetIntegrante(, Val(txtClienteId.Tag), txtNroAfiliado.Text)
        'End If
    End Sub

    Private Sub txtLocalidadId_LostFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles txtLocalidadId.LostFocus
        setLocalidad(Me.txtLocalidadId, Me.txtLocalidadDes, Me.txtPartido)
    End Sub

    Private Sub txtDstLocalidadId_LostFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles txtDstLocalidadId.LostFocus
        setLocalidad(Me.txtDstLocalidadId, Me.txtDstLocalidadDes, Nothing)
    End Sub

    Private Sub txtAn1LocalidadId_LostFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles txtAn1LocalidadId.LostFocus
        setLocalidad(Me.txtAn1LocalidadId, Me.txtAn1LocalidadDes, Me.txtAn1Partido)
    End Sub

    Private Sub txtAn2LocalidadId_LostFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles txtAn2LocalidadId.LostFocus
        setLocalidad(Me.txtAn2LocalidadId, Me.txtAn2LocalidadDes, Me.txtAn2Partido)
    End Sub

    Private Sub txtLocalidadId_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles txtLocalidadId.KeyDown, txtDstLocalidadId.KeyDown, txtAn1LocalidadId.KeyDown, txtAn2LocalidadId.KeyDown
        'If e.KeyCode = Keys.F2 Then
        '    Dim who As TextBox = sender
        '    callInfo = Name & who.Tag
        '    ShowChildFormFloat(frmLocalidadesSearch, Me.DockPanel)
        '    who = Nothing
        'End If
    End Sub

    Private Sub setLocalidad(ByVal pAbr As TextBox, ByVal pDes As TextBox, ByVal pPar As TextBox)
        'Dim objLocalidad As New ShamanCache.clsLocalidades
        'If objLocalidad.Abrir(objLocalidad.GetIDByAbreviaturaId(pAbr.Text)) Then
        '    pAbr.Text = objLocalidad.AbreviaturaId
        '    pDes.Text = objLocalidad.Descripcion & " (" & objLocalidad.PartidoId.AbreviaturaId & ")"
        '    If Not pPar Is Nothing Then pPar.Text = objLocalidad.PartidoId.Descripcion
        'Else
        '    pAbr.Text = ""
        '    pDes.Text = ""
        '    If Not pPar Is Nothing Then pPar.Text = ""
        'End If
        'objLocalidad = Nothing
    End Sub

    Private Sub chkRetorno_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles chkRetorno.CheckedChanged
        If Me.chkRetorno.Enabled Then
            If Me.chkRetorno.CheckState = CheckState.Checked Then
                Me.dtpFecRetorno.Enabled = True
                Me.mskHorRetorno.Enabled = True
            Else
                Me.dtpFecRetorno.Enabled = False
                Me.mskHorRetorno.Enabled = False
            End If
        End If
    End Sub

    Private Sub txtSanatorioId_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles txtSanatorioId.KeyDown, txtDstSanatorioId.KeyDown, txtAn1SanatorioId.KeyDown, txtAn2SanatorioId.KeyDown
        If e.KeyCode = Keys.F2 Then
            Dim who As TextBox = sender
            callInfo = Name & who.Tag
            'ShowChildFormFloat(frmSanatoriosSearch, Me.DockPanel)
            who = Nothing
        End If
    End Sub

    Private Sub txtSanatorioId_LostFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles txtSanatorioId.LostFocus
        setSanatorio(Me.txtSanatorioId, Me.grpOrigen, Me.txtLocalidadId, Me.txtLocalidadDes, Me.txtCalle, Me.txtAltura, Me.txtPiso, Me.txtDepartamento, Me.txtEntreCalle1, Me.txtEntreCalle2, Me.txtReferencias)
    End Sub

    Private Sub txtDstSanatorioId_LostFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles txtDstSanatorioId.LostFocus
        setSanatorio(Me.txtDstSanatorioId, Me.grpDestino, Me.txtDstLocalidadId, Me.txtDstLocalidadDes, Me.txtDstCalle, Me.txtDstAltura, Me.txtDstPiso, Me.txtDstDepartamento, Me.txtDstEntreCalle1, Me.txtDstEntreCalle2, Me.txtDstReferencias)
    End Sub

    Private Sub txtAn1SanatorioId_LostFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles txtAn1SanatorioId.LostFocus
        setSanatorio(Me.txtAn1SanatorioId, Me.grpDestino, Me.txtAn1LocalidadId, Me.txtAn1LocalidadDes, Me.txtAn1Calle, Me.txtAn1Altura, Me.txtAn1Piso, Me.txtAn1Departamento, Me.txtAn1EntreCalle1, Me.txtAn1EntreCalle2, Me.txtAn1Referencias)
    End Sub

    Private Sub txtAn2SanatorioId_LostFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles txtAn2SanatorioId.LostFocus
        setSanatorio(Me.txtAn2SanatorioId, Me.grpDestino, Me.txtAn2LocalidadId, Me.txtAn2LocalidadDes, Me.txtAn2Calle, Me.txtAn2Altura, Me.txtAn2Piso, Me.txtAn2Departamento, Me.txtAn2EntreCalle1, Me.txtAn2EntreCalle2, Me.txtAn2Referencias)
    End Sub

    Private Sub setSanatorio(ByVal pAbr As TextBox, ByVal pGrp As GroupBox, ByVal pLoc As TextBox, ByVal pLds As TextBox, ByVal pCal As TextBox, ByVal pAlt As TextBox, ByVal pPis As TextBox, ByVal pDep As TextBox, ByVal pEt1 As TextBox, ByVal pEt2 As TextBox, ByVal pRef As TextBox)

        'Dim objSanatorio As New ShamanCache.clsSanatorios
        'If objSanatorio.Abrir(objSanatorio.GetIDByAbreviaturaId(pAbr.Text)) Then
        '    Select Case pAbr.Tag
        '        Case 1 : pGrp.Text = "Origen: " & objSanatorio.Descripcion
        '        Case 2 : pGrp.Text = "Destino: " & objSanatorio.Descripcion
        '        Case 3 : pGrp.Text = "Anexo I: " & objSanatorio.Descripcion
        '        Case 4 : pGrp.Text = "Anexo II: " & objSanatorio.Descripcion
        '    End Select
        '    pAbr.Text = objSanatorio.AbreviaturaId
        '    pLoc.Text = objSanatorio.LocalidadId.AbreviaturaId
        '    pLds.Text = objSanatorio.LocalidadId.Descripcion & " (" & objSanatorio.LocalidadId.PartidoId.AbreviaturaId & ")"
        '    pCal.Text = objSanatorio.Domicilio.dmCalle
        '    pAlt.Text = objSanatorio.Domicilio.dmAltura
        '    pPis.Text = objSanatorio.Domicilio.dmPiso
        '    pDep.Text = objSanatorio.Domicilio.dmDepto
        '    pEt1.Text = objSanatorio.Domicilio.dmEntreCalle1
        '    pEt2.Text = objSanatorio.Domicilio.dmEntreCalle2
        '    pRef.Text = objSanatorio.Domicilio.dmReferencia
        'Else
        '    Select Case pAbr.Tag
        '        Case 1 : pGrp.Text = "Origen"
        '        Case 2 : pGrp.Text = "Destino"
        '        Case 3 : pGrp.Text = "Anexo I"
        '        Case 4 : pGrp.Text = "Anexo II"
        '    End Select
        '    pAbr.Text = ""
        'End If
        'objSanatorio = Nothing

    End Sub

    Private Sub cmbIvas_GotFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles cmbIvas.GotFocus
        'Dim objCliente As New clsClientes
        'If objCliente.Abrir(Me.txtClienteId.Tag) Then
        '    If objCliente.AlicuotaIvaId.Porcentaje > 0 Then
        '        Me.cmbIvas.SelectedIndex = 2
        '    Else
        '        Me.cmbIvas.SelectedIndex = 1
        '    End If
        'End If
        'objCliente = Nothing
    End Sub

    Private Sub cmbGrados_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmbGrados.SelectedIndexChanged
        'Dim objGrado As New ShamanCache.clsGradosOperativos(objIncidentesExp.myCnnName)
        'If objGrado.Abrir(getItemData(cmbGrados)) Then flgSetGrado = True
        'objGrado = Nothing
        'SetCoberturaCoPago()
    End Sub

    Private Sub txtCoPago_LostFocus(ByVal sender As Object, ByVal e As System.EventArgs) Handles txtCoPago.LostFocus
        txtCoPago.Text = ShamanClases.prnDblNumber(txtCoPago.Text)
    End Sub

End Class